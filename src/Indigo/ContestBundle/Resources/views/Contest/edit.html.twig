{% extends 'IndigoMainBundle:Pixel:base.html.twig' %}

{% block title %}{{ 'contest_edit'|trans }}{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link href="{{ asset('bundles/indigomain/bower_components/bootstrap-fileinput/css/fileinput.min.css') }}" media="all" rel="stylesheet" type="text/css" />
    <link href="{{ asset('bundles/indigomain/bower_components/eternicode-bootstrap-datepicker/dist/css/bootstrap-datepicker3.min.css') }}" rel="stylesheet" type="text/css"/>
    <link href="{{ asset('bundles/indigomain/bower_components/bootstrap-switch-master/dist/css/bootstrap3/bootstrap-switch.min.css') }}" rel="stylesheet" type="text/css"/>
    <link href="{{ asset('bundles/indigomain/bower_components/seiyria-bootstrap-slider/css/bootstrap-slider.css') }}" rel="stylesheet" type="text/css"/>
{% endblock %}

{% block body -%}
    <div class="col-sm-10 col-sm-offset-1">
    <h1>{{ 'contest_edit'|trans }}</h1>

    {{ form_start(edit_form) }}
    {{ form_row(edit_form.user) }}
    {{ form_row(edit_form.contestTitle) }}
    {{ form_row(edit_form.image) }}
    {{ form_row(edit_form.tableName) }}
    {{ form_row(edit_form.contestType) }}
    {{ form_row(edit_form.scoreLimit, {'attr' : {'data-slider-value' : entity.scoreLimit }}) }}
    <div class="form-group">
        <label class="col-sm-2 control-label required">{{ 'period'|trans }}</label>
        <div class="col-sm-10">
            <div class="input-daterange input-group date" id="datepicker">
                {{ form_widget(edit_form.contestStartingDate) }}
                <span class="input-group-addon">{{ 'to'|trans|lower }}</span>
                {{ form_widget(edit_form.contestEndDate) }}
            </div>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label required">{{ 'create_contest.form.contest_privacy'|trans }}</label>
        <div class="col-sm-10">
            {{ form_widget(edit_form.contestPrivacy, {'data' : edit_form.contestPrivacy, 'attr' : {'data-on-text' : 'yes'|trans, 'data-off-text' : 'no'|trans}}) }}
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label required"></label>
        <div class="col-sm-10">
            <button type="button" class="btn btn-info" data-toggle="collapse" data-target="#optionalPrize">
                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> {{ 'add_prize'|trans }} ({{ 'optional'|trans }})
            </button>
        </div>
    </div>
    <div id="optionalPrize" class="collapse">
        {{ form_row(edit_form.prize) }}
        {{ form_row(edit_form.prizeImage) }}
    </div>
    {{ form_end(edit_form) }}
    <div class="form-group">
        <label class="col-sm-2 control-label required"></label>
        <div class="col-sm-10" style="padding-left:5px;">
            <a href="{{ path('contest_delete', { 'id': entity.id }) }}" title="{{ 'delete'|trans }}" class="btn btn-danger">
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> {{ 'delete'|trans }}
            </a>
            <a href="{{ path('contest') }}" title="{{ 'back_to_the_list'|trans }}" class="pull-right btn btn-default">
                <span class="glyphicon glyphicon-th-list" aria-hidden="true"></span> {{ 'back_to_the_list'|trans }}
            </a>
        </div>
    </div>
    </div>
{% endblock %}

{% block javascripts %}
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
    <script src="{{ asset('bundles/indigomain/bower_components/bootstrap-fileinput/js/fileinput.min.js') }}"></script>
    <script src="{{ asset('bundles/indigomain/bower_components/bootstrap-fileinput/js/fileinput_locale_') }}{{ app.request.getLocale() }}.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js" type="text/javascript"></script>

    {{ parent() }}

    <script src="{{ asset('bundles/indigomain/bower_components/eternicode-bootstrap-datepicker/js/bootstrap-datepicker.js') }}"></script>
    <script src="{{ asset('bundles/indigomain/bower_components/eternicode-bootstrap-datepicker/js/locales/bootstrap-datepicker.') }}{{ app.request.getLocale() }}.js"></script>
    <script src="{{ asset('bundles/indigomain/bower_components/bootstrap-switch-master/dist/js/bootstrap-switch.min.js') }}"></script>

    <script src="{{ asset('bundles/indigomain/bower_components/seiyria-bootstrap-slider/js/bootstrap-slider.js') }}"></script>

    <script>
        $('#indigo_contestbundle_contest_scoreLimit').bootstrapSlider({});

        /* Initialize your widget via javascript as follows */
        $(".contestLogo").fileinput({
            previewFileType: "image",
            browseClass: "btn btn-success",

            browseIcon: '<i class="glyphicon glyphicon-picture"></i>',
            removeClass: "btn btn-danger",

            removeIcon: '<i class="glyphicon glyphicon-trash"></i>',
            uploadClass: "btn btn-info",

            uploadIcon: '<i class="glyphicon glyphicon-upload"></i>',
            layoutTemplates: {
                main1: "{preview}\n" +
                "<div class=\'input-group {class}\'>\n" +
                "   <div class=\'input-group-btn\'>\n" +
                "       {browse}\n" +
                "       {upload}\n" +
                "       {remove}\n" +
                "   </div>\n" +
                "   {caption}\n" +
                "</div>"
            },
            showCaption: false,
            showRemove: true,
            showUpload: false,
            allowedFileExtensions: ["jpg", "gif", "png", "jpeg"],
            overwriteInitial: true,
            initialPreview: [
                "<img src='{{ asset('uploads/contest/') }}{{ imagePath }}' class='file-preview-image' alt='*'>"
            ],
            maxFileSize: 1000
        });

        $(".contestPrizeImages").fileinput({
            previewFileType: "image",
            browseClass: "btn btn-success",

            browseIcon: '<i class="glyphicon glyphicon-picture"></i>',
            removeClass: "btn btn-danger",

            removeIcon: '<i class="glyphicon glyphicon-trash"></i>',
            uploadClass: "btn btn-info",

            uploadIcon: '<i class="glyphicon glyphicon-upload"></i>',
            layoutTemplates: {
                main1: "{preview}\n" +
                "<div class=\'input-group {class}\'>\n" +
                "   <div class=\'input-group-btn\'>\n" +
                "       {browse}\n" +
                "       {upload}\n" +
                "       {remove}\n" +
                "   </div>\n" +
                "   {caption}\n" +
                "</div>"
            },
            showCaption: false,
            showRemove: true,
            showUpload: false,
            allowedFileExtensions: ["jpg", "gif", "png", "jpeg"],
            overwriteInitial: true,
            {% if prizeImagePath %}
            initialPreview: [
                "<img src='{{ asset('uploads/prizes/') }}{{ prizeImagePath }}' class='file-preview-image' alt='*'>"
            ],
            {% endif %}
            maxFileSize: 3000
        });

        $(".input-daterange").datepicker({
            todayHighlight: true,
            autoclose: false,
            language: '{{ app.request.getLocale() }}',
            startDate: new Date()
        });

        $('.privacySwitchButton').bootstrapSwitch();
    </script>
{% endblock %}